<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>



<script src="../../third-party/closure/closure/goog/base.js"></script>
<script src="../deps.js"></script>
<script src="../../specviewTest/data/cmlfile.js"></script>
<script>
    goog.require('goog.events.EventType');
    goog.require('goog.ui.Select');
    goog.require('specview.controller.Controller');
    goog.require('specview.controller.plugins.Highlight');
    goog.require('specview.util.Utilities')
    goog.require('specview.controller.plugins.Zoom');
    goog.require('specview.io.SpectrumCMLParser');
    goog.require('specview.model.NMRdata');
    goog.require('goog.events.MouseWheelHandler');
    goog.require('goog.fx.Dragger');
    goog.require('goog.dom');
    goog.require('goog.math');
    goog.require('goog.ui.DragDropDetector');
    goog.require('goog.style');
    goog.require('goog.graphics');
    
    
    goog.require('goog.debug.DivConsole');
    goog.require('goog.debug.Logger');
    goog.require('goog.debug.LogManager');
    goog.require('goog.dom');
    goog.require('goog.events');
    goog.require('goog.object');
    goog.require('goog.ui.Component.EventType');
    goog.require('goog.ui.DimensionPicker');
    
</script>

<script>

//editor=null;
spectrumData=null;
zoom=0;

document.atomSensitivity = 6;
document.bondSensitivity = 6;
document.peakSensitivity = 10;

document.changeAtomColor = false;
document.changeBondColor = false;
document.changePeakColor = false;

document.experimentOfTheUser = null;


//document.decimalcolor = null;

function initPage(){

			var isGrid=false;
			var isAxis=false;
			// uncomment next two lines to debug to console						
			var c = new goog.debug.Console(); 
			c.setCapturing(true); 
			
//			var toolbar = new specview.controller.DefaultToolbar.makeDefaultMoleculeToolbar(goog.dom.getElement('moleculeEditorToolbar'));  

			var cmlData=cmlmolecules.split("$$END$$\n");
			var xmlDoc=specview.io.SpectrumCMLParser.getDocument(cmlData[29]);//XML document
			spectrumData=new specview.model.NMRdata();
			spectrumData=specview.io.SpectrumCMLParser.parseDocument(spectrumData,xmlDoc,navigator.appName);//a cmlObject
			
			//Create the canvas and provide it with highlight plugins
			editor = new specview.controller.Controller(goog.dom.getElement('moleculeContainer'),{background : {color : 'white'}});
			editor.registerPlugin(new specview.controller.plugins.Highlight());
			editor.registerPlugin(new specview.controller.plugins.Zoom());
//			editor.registerPlugin(new specview.controller.plugins.BondEdit());
			spectrumData.editor=editor;

			spectrumData.setCoordinatesWithPixels(editor)

			editor.setSpecObject(spectrumData);
			document.metaSpecObject = spectrumData;

			document.editorObject = editor;
			document.staticGraphics = goog.graphics.createGraphics(1200,400);
			
			
			editor.setModels([spectrumData],false);
			editor.spectrumRenderer.renderAxis(spectrumData,editor.spectrumRenderer.box,'black');
			editor.spectrumRenderer.renderGrid(editor.specObject.mainSpecBox,'black',spectrumData.spectrum);


			
			//Display the informations about the molecule
		    goog.dom.getElement("molName").innerHTML="<b>Molecule name: </b>"+spectrumData.molecule.name;
		    goog.dom.getElement("molId").innerHTML="<b>Molecule id: </b>"+spectrumData.molecule.molecule_id;
     		goog.dom.getElement("experimentType").innerHTML="<b>Experiment type: </b>"+spectrumData.experienceType;

			//Creation of the tool bar
		    var select1 = new goog.ui.Select();
//		    select1.addItem(new goog.ui.MenuItem('NMR_0', 0));
//		    select1.addItem(new goog.ui.MenuItem('NMR_1', 1));
//		    select1.addItem(new goog.ui.MenuItem('NMR_2', 2));
//		    select1.addItem(new goog.ui.MenuItem('NMR_3', 3));
//		    select1.addItem(new goog.ui.MenuItem('NMR_4', 4));
//		    select1.addItem(new goog.ui.MenuItem('NMR_5', 5));
//		    select1.addItem(new goog.ui.MenuItem('NMR_6', 6));
//		    select1.addItem(new goog.ui.MenuItem('NMR_7', 7));
//		    select1.addItem(new goog.ui.MenuItem('NMR_8', 8));
//		    select1.addItem(new goog.ui.MenuItem('NMR_9', 9));
//		    select1.addItem(new goog.ui.MenuItem('NMR_10', 10));
//		    select1.addItem(new goog.ui.MenuItem('NMR_11', 11));
//		    select1.addItem(new goog.ui.MenuItem('NMR_12', 12));
//		    select1.addItem(new goog.ui.MenuItem('MS_0 (very old cml file)', 13));
//		    select1.addItem(new goog.ui.MenuItem('Narengenin)', 14));
//		    select1.addItem(new goog.ui.MenuItem('chEBI:776', 15)); 
//		    select1.addItem(new goog.ui.MenuItem('chEBI:1734', 16));
//		    select1.addItem(new goog.ui.MenuItem('chEBI:1895 (problem in mol coords)', 17));
//		    select1.addItem(new goog.ui.MenuItem('chEBI:2303', 18));
//		    select1.addItem(new goog.ui.MenuItem('chEBI:776', 19));
//		    select1.addItem(new goog.ui.MenuItem('16alpha-hydroxyestrone (SAIDs NTOBM)', 20));
//		    select1.addItem(new goog.ui.MenuItem('4-O methylsoflavone (SAIDs NNTOM)', 21));
//		    select1.addItem(new goog.ui.MenuItem('8-(1,1-dimethylallyl)galangin (SAIDs NTOBM)', 22));
//		    select1.addItem(new goog.ui.MenuItem('(+)-absicissic acid (SAIDs NNTM)', 23));
//		    select1.addItem(new goog.ui.MenuItem('amoxiciline (SAIDs NNTM)', 24));
//		    select1.addItem(new goog.ui.MenuItem('8-(1,1-dimethylallyl)galangin (SAIDs NNTM)', 25));
//		    select1.addItem(new goog.ui.MenuItem('benzatrapone (SAIDs NNTM)', 26));
//		    select1.addItem(new goog.ui.MenuItem('betaxolone (SAIDs NNTM)', 27));
//		    select1.addItem(new goog.ui.MenuItem('biperiden (SAIDs NNTM)', 28));
//		    select1.addItem(new goog.ui.MenuItem('Bigass molecule (SAIDsc NNTM)', 29));
//		    select1.addItem(new goog.ui.MenuItem('brinzolamide (SAIDsc NNTM)', 30));
//		    select1.addItem(new goog.ui.MenuItem('MS/MS (SAIDsc NNTM)', 31));
//		    select1.addItem(new goog.ui.MenuItem('Fake spectrum(test) ', 32));		     
//		    		    select1.setSelectedIndex(0);
//		    select1.render(goog.dom.getElement('selectMolecule'));
		    
		
//		    goog.events.listen(select1, goog.ui.Component.EventType.ACTION,
//		    function(e) {
//		    	zoom=0;
//		      isGrid=false;
//		      isAxis=false;
//		      var select = e.target;
//		      var idx = select.getValue();
//		      if(cmlData[idx]==undefined){
//		          alert("NO SUCH MOLECULE IN THE ARRAY! Default molecle will be displayed : ")
//		          idx=0;
//		      }
//		      var molfile=cmlData[idx];
//	      alert(molfile)
//		      var xmlDox;
//		      xmlDoc=specview.io.SpectrumCMLParser.getDocument(molfile);//XML document
//			      spectrumData=new specview.model.NMRdata();
//			      spectrumData=specview.io.SpectrumCMLParser.parseDocument(spectrumData,xmlDoc);//a cmlObject
//				  spectrumData.setCoordinatesWithPixels(editor,0)
		//CAREFUL WITH THE FOLLOWING LINE
//			  editor.setSpecObject(spectrumData);
//		      editor.setModels([spectrumData]);
//		      editor.spectrumRenderer.renderAxis(spectrumData,editor.spectrumRenderer.box,'black');
//			  editor.spectrumRenderer.renderGrid(editor.specObject.mainSpecBox,'black',spectrumData.spectrum);
//			  document.metaSpecObject = spectrumData;
//			  goog.dom.getElement("molName").innerHTML="<b>Molecule name: </b>"+spectrumData.molecule.name;
//			  goog.dom.getElement("molId").innerHTML="<b>Molecule id: </b>"+spectrumData.molecule.molecule_id;
//			  goog.dom.getElement("experimentType").innerHTML="<b>Experiment type: </b>"+spectrumData.experienceType;
		      
//		    });
	    
		    //Display all the buttons
	//	    <input id="helpButton" style="display:none" class = "button" type = "button" name = "chk1" onclick = "ShowContent('floatingBoxHelp')" value = "A little help?">
	//	    <input id="expandButton" style="display:none" class = "button" type = "button" name = "chk1" onclick = "expandSpectrum()" value = "Expand spetrum">
	//	    <input id="unzoomButton" style="display:none" class = "button" type = "button" name = "chk1" onclick = "unzoom()" value = "Unzoom">
	//	    <input id="resetMoleculeButton" style="display:none" class = "button" type = "button" name = "chk1" onclick = "resetMolecule()" value = "Reset Molecule">
	//	    <input id="resetSpectrumButton" style="display:none" class = "button" type = "button" name = "chk1" onclick = "resetSpectrum()" value = "Reset Spectrum">
	//	    document.getElementById("expandButton").style.top = spectrumData.mainSpecBox[2].y;
	//	    document.getElementById("expandButton").style.display="block";
	//	    document.getElementById("unzoomButton").style.top = spectrumData.mainSpecBox[2].y;
	//	    document.getElementById("unzoomButton").style.display="block";
	//	    document.getElementById("resetSpectrumButton").style.left = spectrumData.mainSpecBox[2].y;
	//	    document.getElementById("resetSpectrumButton").style.display="block";
	//	    document.getElementById("helpButton").style.display="block";
	//	    document.getElementById("resetMoleculeButton").style.display="block";
};
goog.events.listen(window, goog.events.EventType.LOAD, initPage);



//window.onscroll = function () {
//   var oTextbox = document.getElementById("txt1");
//  oTextbox.value += "\nscroll is at " + document.body.scrollLeft + " horizontally and " + document.body.scrollTop + " vertically.";
//}

function expandSpectrum(){
	spectrumData.expand = true;
	editor.expandSpectrum();
}

document.showParentSpectrum = function (){

}


document.showChildSpectrum = function(){
	var showMolecule = document.getElementById("showChildMoleculeOption").checked;
	var showSpectrum = document.getElementById("showChildSpectrumOption").checked;
	if(showMolecule || showSpectrum){
		
		editor.showChild(showMolecule,showSpectrum);
	}
}

function resetSpectrum(){
	editor.clearSamy(spectrumData.spectrum, spectrumData.mainSpecBox,spectrumData.transform);
}

function resetMolecule(){
	editor.clearSamy(spectrumData.molecule,spectrumData.mainMolBox,spectrumData.transform);	
}

function displayColor(){
}


</script>

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<title>Display spectrum demo</title>
	<link rel="stylesheet" href="../../css/specview.css" />
	<link rel="stylesheet"  href="../../css/demo.css" />
	 <img name="logoMetabolight"  src="../../images/searchBox.png"
	 	  width="1400" height="100" alt="Zoom Tool"  title="Zoom Tool"/>
	 <img name="Metabolight"  src="../../images/banner.png"
 	 	  style="position:absolute;left:25px;top:35px;display:block;z-index:10;"/>
 	<META NAME="keywords" content="html, color, codes, chart, picker, hex">
	<link rel="shortcut icon" href="http://c453312.r12.cf2.rackcdn.com/favicon_001.ico" />
	<script type="text/javascript">
		  var _gaq = _gaq || [];
		  _gaq.push(['_setAccount', 'UA-814714-1']);
  		  _gaq.push(['_trackPageview']);

 		 (function() {
	     var ga = document.createElement('script');
    	 ga.type = 'text/javascript'; ga.async = true;
    	 ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
   	 	 var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  		})();
	</script>
 	 
 	 
 	 	  
</head>




<body>


<script type="text/javascript" language="JavaScript">
var cX = 0; var cY = 0; var rX = 0; var rY = 0;


function UpdateCursorPosition(e){
	cX = e.pageX; cY = e.pageY;
}

function UpdateCursorPositionDocAll(e){
	cX = event.clientX; cY = event.clientY;
	}

if(document.all) { 
	document.onmousemove = UpdateCursorPositionDocAll; 
}else{
	document.onmousemove = UpdateCursorPosition; 
}

function AssignPosition(d) {
	if(self.pageYOffset) {
		rX = self.pageXOffset;
		rY = self.pageYOffset;
		}
	else if(document.documentElement && document.documentElement.scrollTop) {
		rX = document.documentElement.scrollLeft;
		rY = document.documentElement.scrollTop;
		}
	else if(document.body) {
		rX = document.body.scrollLeft;
		rY = document.body.scrollTop;
		}
	if(document.all) {
		cX += rX; 
		cY += rY;
		}
	d.style.left = (cX+10) + "px";
	d.style.top = (cY+10) + "px";
}

/*
* Hide the floating window
*/
document.HideContent = function(d) {
	if(d=="floatingBoxColor"){
		document.changeAtomColor = false;
		document.changeBondColor = false;
		document.changePeakColor = false;
	}
	if(d.length < 1) {
		return; 
	}
	document.getElementById(d).style.display = "none";
	specview.controller.plugins.Highlight.zoomObject=null;
};

/**
* Display a floating window
*/

document.ShowContent = function(d,objet) {
	switch(objet){
	case "atom":
		document.changeAtomColor = true;
		break;
	case "bond":
		document.changeBondColor = true;
		break;
	case "peak":
		document.changePeakColor = true;
		break;
	default :
		break;
	}
	if(d.length < 1) {
		return; 
	}
	var dd = document.getElementById(d);
	AssignPosition(dd);
	dd.style.display = "block";
};

function ReverseContentDisplay(d) {
	if(d.length < 1) { return; }
	var dd = document.getElementById(d);
	AssignPosition(dd);
	if(dd.style.display == "none") { dd.style.display = "block"; }
	else { dd.style.display = "none"; }
}
//-->




</script>





<div 
 id="floatingBox" 
 style="display:none; 
    position:absolute; 
    border-style: double;
    background-color: #AAAAAA; 
    padding: 1px;">
    This peak is the<br> parent of a spectrum.<br><br>
<li>
Child spectrum :
</li>
	<ul>
		<li>
		Show molecule ?<input type="checkbox" id="showChildMoleculeOption" checked>
		</li>
		<li>
		Show spectrum ?<input type="checkbox" id="showChildSpectrumOption" checked>  
		</li>
		<li>
		<input type="button" onclick="document.showChildSpectrum()" value="Show child">
<!-- <a id="showChildSpectrum" href="javascript:showChildSpectrum" >Show child</a> -->		
		</li>
	</ul>
<li>
Parent spectrum :
</li>
	<ul>
		<li>
		Show molecule ?<input type="checkbox" id="showParentMoleculeOption" checked>
		</li>
		<li>
		Show spectrum ?<input type="checkbox" id="showParentSpectrumOption" checked>  
		</li>
		<li>
		<input type="button" onclick="document.showParentSpectrum()" value="Show parent">
<!-- <a id="showParentSpectrum" href="javascript:showParentSpectrum" >Show Parent</a> -->		
		</li>
	</ul>
<br>
<li>
<a 
 onmouseover="document.HideContent('floatingBox'); return true;"
 href="javascript:HideContent('floatingBox')">
Hide the window
</a>
</li>
</div>


<input id="helpButton"  class = "button" type = "button" name = "chk1" onclick = "ShowContent('floatingBoxHelp')" value = "A little help?">
<input id="expandButton"  class = "button" type = "button" name = "chk1" onclick = "expandSpectrum()" value = "Expand spetrum">
<input id="unzoomButton"  class = "button" type = "button" name = "chk1" onclick = "unzoom()" value = "Unzoom">
<!-- <input id="resetMoleculeButton"  class = "button" type = "button" name = "chk1" onclick = "resetMolecule()" value = "Reset Molecule">
<input id="resetSpectrumButton"  class = "button" type = "button" name = "chk1" onclick = "resetSpectrum()" value = "Reset Spectrum">
 
  	<input class = "button" id = "launch" type = "button" onclick = "launch()" value="View experiment">
 	
 	<input class = "button"	id="cmlInputFile"	type = "file"> -->
<input id="textCmlInput" class="button" type="button" onclick="ShowContent('floatingBoxInputCmlContent')" value="Input file content">
<input id="random entry" class="button" type="button" onclick="ShowRandomEntry()" value="Show random entry">



<script type = "text/javascript">

function ShowRandomEntry (){
	var randInt = getRandomInt(0,30);
	var cmlData=cmlmolecules.split("$$END$$\n");

	var xmlDoc=specview.io.SpectrumCMLParser.getDocument(cmlData[randInt]);//XML document


//	xmlDoc=specview.io.SpectrumCMLParser.getDocument(document.experimentOfTheUser);//XML document
    spectrumData=new specview.model.NMRdata();
    spectrumData=specview.io.SpectrumCMLParser.parseDocument(spectrumData,xmlDoc);//a cmlObject
	spectrumData.setCoordinatesWithPixels(editor,0)
	editor.setSpecObject(spectrumData);
	editor.setModels([spectrumData]);
	editor.spectrumRenderer.renderAxis(spectrumData,editor.spectrumRenderer.box,'black');
	editor.spectrumRenderer.renderGrid(editor.specObject.mainSpecBox,'black',spectrumData.spectrum);
	document.metaSpecObject = spectrumData;
	
	//Display the informations about the molecule
    goog.dom.getElement("molName").innerHTML="<b>Molecule name: </b>"+spectrumData.molecule.name;
    goog.dom.getElement("molId").innerHTML="<b>Molecule id: </b>"+spectrumData.molecule.molecule_id;
		goog.dom.getElement("experimentType").innerHTML="<b>Experiment type: </b>"+spectrumData.experienceType;

//	alert(randInt)
};


function getRandomInt (min, max) {
    return Math.floor(Math.random() * (max - min + 1)) + min;
}


function unzoom(){
	document.editorObject.unzoom();
}


//Function called when the user click on "view experiment"
function launch(){
//	document.metaSpecObject.cmlString = document.getElementById("CMLinputText").value;
//	alert( document.getElementById("cmlInputFile").files[0].getAsText("utf-8"));
//	var dir = "/home/epu/metabolomes/metabolomes/trunk/specview/src/main/javascript/specview/specviewTest/data/cml/";
//	var dir2 = "../../specviewTest/data/cml/"
//	var file = dir2 + document.getElementById("cmlInputFile").value;
//	document.experimentOfTheUser = document.javaApplet.parse(file)
//	document.experimentOfTheUser = document.metaSpecObject.cmlString;
	xmlDoc=specview.io.SpectrumCMLParser.getDocument(document.experimentOfTheUser);//XML document
    spectrumData=new specview.model.NMRdata();
    spectrumData=specview.io.SpectrumCMLParser.parseDocument(spectrumData,xmlDoc);//a cmlObject
	spectrumData.setCoordinatesWithPixels(editor,0)
	editor.setSpecObject(spectrumData);
	editor.setModels([spectrumData]);
	editor.spectrumRenderer.renderAxis(spectrumData,editor.spectrumRenderer.box,'black');
	editor.spectrumRenderer.renderGrid(editor.specObject.mainSpecBox,'black',spectrumData.spectrum);
	document.metaSpecObject = spectrumData;
}


function getCMLString(){

 	var f = "/home/epu/metabolomes/metabolomes/trunk/specview/src/main/javascript/specview/specviewTest/data/massSpecData/test.xml"
	var g = "/home/epu/test1_frag.cml.1.xml"
	var g1 = "/home/epu/specData/ms/test1_frag.cml.1.xml"
	var g2 = "/home/epu/test1_frag.cml.2.xml"
	var h = "/home/epu/metabolomes/metabolomes/trunk/specview/src/main/javascript/specview/specviewTest/data/nmrData/nmrTest1.xml"
	var i = "/home/epu/specData/nmr/nmrTest1.xml"
	
	
	var j = "/home/epu/specData/ms/test1_frag.cml.1.xml"
	document.experimentOfTheUser = document.javaApplet.parse(i);
//	alert(document.javaApplet.parse(i));
}

var count = 0;
function newPage(page) {
	if (count == 0) {  // once only
		count ++;
//		page = "file://localhost/home/epu/metabolomes/metabolomes/trunk/specview/src/main/javascript/specview/specview/controller/help.html"
		OpenWin = this.open(page,"CtrlWindow",
						 "top=80,left=100,screenX=100,screenY=80,width=550,height=460,toolbar=no,menubar=no,location=no, scrollbars=no,resizable=yes");
		}

function closepop() 
{
	if (OpenWin != null)
		OpenWin.close() 
	}
window.onunload = closepop;
count = 0;
}


</script>

	<fieldset id="fieldSet" style="width:1200px; border: none" >
      <legendstyle="top:143px"><h1>MetaboLight Spectrum viewer</h1></legend>
      <br>
      <li id="molName"></li>
      <li id="molId"></li>
      <li id="experimentType"></li>
      <li id="experimentId"><b>Experiment id: </b><script>//document.write(spectrumData.molecule.name)</script></li>
   
   
   <div id="colorOption"
      style="top: 143px;
			   left: 470px;
  		   position: absolute;
		       z-index: 1;
  		   visibility: show;">
	<b>+Select your highlighting options</b><br><br>
	 -Atoms
   <input type="button"  id = "atomHighlightColor" size="1" value="#FF4924">
   <input  class = "button" type = "button" name = "chk1" onclick = "ShowContent('floatingBoxColor','atom')"  value = "More color?"> <br>
	-Bonds
   <input type="button" id = "bondHighlightColor" size="1" value="#FF4924">
   <input class = "button" type = "button" name = "chk1" onclick = "ShowContent('floatingBoxColor','bond')" value = "More color?"><br>
	-Peaks
   <input type="button"  id = "peakHighlightColor" size="1" value="#FF4924">
   <input class = "button" type = "button" name = "chk1" onclick = "ShowContent('floatingBoxColor','peak')" value = "More color?">
	 </div>
	 
	   

	 

<script>

  function modifySensitivity(object,sign){
		switch(object){
		case "atom" :
			var max = document.atomSensitivity == 1;
			var min = document.atomSensitivity == 10;
			if(document.atomSensitivity > 1){
				sign=="+" ? document.atomSensitivity -= 1 : document.atomSensitivity += 1;
			}else if(max && sign=="-"){
				document.atomSensitivity += 1;
			}else if(min && sign=="+"){
				document.atomSensitivity -= 1;
			}else if(max && sign=="+"){
				alert("maximum sensitivity reached");
			}else if(min && sign=="-"){
				alert("minimum sensitivity reached")
			}
			document.getElementById("atomSensitivityValue").value = document.atomSensitivity + "px"
			break;
		case "bond" :
			var max = document.bondSensitivity == 1;
			var min = document.bondSensitivity == 10;
			if(document.bondSensitivity > 1 ){
				sign=="+" ? document.bondSensitivity -= 1 : document.bondSensitivity += 1;
			}else if(max && sign=="-"){
				document.bondSensitivity += 1;
			}else if(min && sign=="+"){
				document.bondSensitivity -= 1;
			}else if(max && sign=="+"){
				alert("maximum sensitivity reached");
			}else if(min && sign=="-"){
				alert("minimum sensitivity reached")
			}
			document.getElementById("bondSensitivityValue").value = document.bondSensitivity + "px"
			break;
		case "peak" :
			var max = document.peakSensitivity == 1;
			var min = document.peakSensitivity == 10;
			if(document.peakSensitivity > 1 ){
				sign=="+" ? document.peakSensitivity -= 1 : document.peakSensitivity += 1;
			}else if(max && sign=="-"){
				document.peakSensitivity += 1;
			}else if(min && sign=="+"){
				document.peakSensitivity -= 1;
			}else if(max && sign=="+"){
				alert("maximum sensitivity reached");
			}else if(min && sign=="-"){
				alert("minimum sensitivity reached")
			}
			document.getElementById("peakSensitivityValue").value = document.peakSensitivity + "px"
			break;
		default :
			alert("")
			break;
		}
  }

 function setSensitivity(object){
	 switch(object){
		 case "atom" :
			 document.atomSensitivity = specview.util.Utilities.parsePixel(document.getElementById("atomSensitivityValue").value)
			 break;
		 case "bond" :
			 document.bondSensitivity = specview.util.Utilities.parsePixel(document.getElementById("bondSensitivityValue").value)
			 break;
		 case "peak" :
			 document.peakSensitivity = specview.util.Utilities.parsePixel(document.getElementById("peakSensitivityValue").value)
			 break;
		 default :
			 break;
	 }
 }  
 
 function zoomOnSpectrum(){
	 var x1 = document.getElementById("zoomMinValue").value;
	 var x2 = document.getElementById("zoomMaxValue").value;
	 var arrayOfPeaks = document.editorObject.neighborList.getObjectsFromXvalue("spectrum",x1,x2);
	 var highlightObject = new specview.controller.plugins.Highlight();
	 editor = document.editorObject;
	 highlightObject.zoomOnSpectrum2(arrayOfPeaks,editor);
 }
</script>


<div	style="top: 143px;
			   left: 740px;
  		   position: absolute;
		       z-index: 1;
  		   visibility: show;">
	<b>+Select your sensitivity</b><br><br>
	-Atoms  <input class="smallButton" type="button" id="atomSensitivity" value="-" onclick="modifySensitivity('atom','-')">
			<input class="smallButton" type="button" id="atomSensitivity" value="+" onclick="modifySensitivity('atom','+')">
			<input class = "smallButton" type="text" id="atomSensitivityValue" value="6px" onchange="setSensitivity('atom')">
			<br>
			
	-Bonds  <input class="smallButton" type="button" id="bondSensitivity" value="-" onclick="modifySensitivity('bond','-')">
			<input class="smallButton" type="button" id="atomSensitivity" value="+" onclick="modifySensitivity('bond','+')">
			<input class = "smallButton" type="text" id="bondSensitivityValue" value="6px" onchange="setSensitivity('bond')">
			<br>
			
	-Peaks  <input class="smallButton" type="button" id="peakSensitivity" value="-" onclick="modifySensitivity('peak','-')">
			<input class="smallButton" type="button" id="atomSensitivity" value="+" onclick="modifySensitivity('peak','+')">
			<input class = "smallButton" type="text" id="peakSensitivityValue" value="10px" onchange="setSensitivity('peak')">
</div>

   
   <div
		style="top: 143px;
		left: 920px;
		position: absolute;
		z-index: 1;
		visibility: show;"   
   >
      +<b>Zoom between the value:</b><br>   
   </div>
   <div
   		style="top: 163px;
		left: 920px;
		position: absolute;
		z-index: 1;
		visibility: show;"
   >
   
    <input  id="zoomMinValue" type="text" size="5"> and
    <input  id="zoomMaxValue" type="text" size="5"><br>
    
   <input class="button" type="button" id="zoom" value="zoom" onclick="javascript:zoomOnSpectrum()"><br>   
   
   </div>

   
<!--  <label id="selectMolecule">Select a spectrum to render: </label> -->     
      <br>
      <div id="moleculeContainer" style="height:800px">
      
      <div
      	onmouseover=" javascript:dragger()"
      	onmouseout="javascript:donnut()"
      	onmouseup = "javascript:setDraggingToolSelection(false)"
		class="draggingBar"
		id="draggingBarSpectrum"
		style="width:100px;
		position:relative;
		top:700px;
		left:100px;
		cursor:pointer;
		display:none"
		
>
<--drag--->

</div>
      
	<div
		
			
	>
	
	
	</div>      

      
      </div>
	</fieldset>

<div
id="floatingBoxInputCmlContent";
style="display:none;
	position:absolute; 
    border-style: double;
    background-color: #FFFFFF; 
    padding: 1px;"
>
Copy paste here after the content of your .cml file<br/>
<textarea rows="20" cols="20" id="CMLinputText" value="" wrap = "off"></textarea><br/>
<input type="button" onclick="launch()"; return true;" value="View experiment !"><br/>
<a 
 onmouseover="document.HideContent('floatingBoxInputCmlContent'); return true;"
 href="javascript:HideContent('floatingBoxInputCmlContent')">
Hide the window
</a>
</div>

<!-- ################################ COLOR FLOATING BOX ############################ -->
<!--  The following div element is a floatting window presenting all the possible existing colors -->
<div 
 id="floatingBoxColor" 
 style="display:none; 
    position:absolute; 
    border-style: double;
    background-color: #FFFFFF; 
    padding: 1px;">
    
<!-- The content of the floatting window -->	
<a name="HTML_Color_Picker"></a>

<div id="insertcolor">
<input type="text" maxlength="7" value="FFFFFF" id="startcolor" name="startcolor">
<button id="newcolor">GO</button>
</div> 



<div id="container"></div>
<!-- javaskripti -->


<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/yui/2.8.0r4/build/yahoo-dom-event/yahoo-dom-event.js"></script>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/yui/2.8.0r4/build/dragdrop/dragdrop-min.js"></script>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/yui/2.8.0r4/build/slider/slider-min.js"></script>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/yui/2.8.0r4/build/element/element-min.js"></script>
<script type="text/javascript" src="http://c453312.r12.cf2.rackcdn.com/ycp.js"></script>
<script type="text/javascript" language="javascript">
(function() {
 var Event = YAHOO.util.Event, picker, hexcolor;
 var hexRepresentation ;
 Event.onDOMReady(function() {
 picker = new YAHOO.widget.ColorPicker("container", {
 showhsvcontrols: true,
 showhexcontrols: true,
 showwebsafe: false,
					images: {
						HUE_THUMB: "http://c453312.r12.cf2.rackcdn.com/hue_thumb.png",
						PICKER_THUMB: "http://ajax.googleapis.com/ajax/libs/yui/2.8.0r4/build/colorpicker/assets/picker_thumb.png"
 				} });
			picker.skipAnim=true;	
			var onRgbChange = function(o) {
				setTimeout ("document.getElementById('yui-picker-hex').select()", 50);
				hexcolor = cc(document.getElementById('startcolor').value);
				hexRepresentation = specview.util.Utilities.d2h(o.newValue).toUpperCase();
				if(document.changeAtomColor){
					document.editorObject.atomColor = hexRepresentation
					document.getElementById("atomHighlightColor").value = hexRepresentation 
				}else if(document.changeBondColor){
					document.editorObject.bondColor = hexRepresentation
					document.getElementById("bondHighlightColor").value = hexRepresentation 
				}else if(document.changePeakColor){
					document.editorObject.peakColor = hexRepresentation
					document.getElementById("peakHighlightColor").value = hexRepresentation 
				}
			}
			picker.on("rgbChange", onRgbChange);
			Event.on("newcolor", "click", function(e) {
				hexcolor = cc(document.getElementById('startcolor').value);
				picker.setValue([HexToR(hexcolor), HexToG(hexcolor), HexToB(hexcolor)], false);
				alert(picker.setValue([HexToR(hexcolor), HexToG(hexcolor), HexToB(hexcolor)], false))
				document.color = document.getElementById('newcolor').value
				
			});
 });
})();
</script>
<input type="button" onclick="document.HideContent('floatingBoxColor'); return true;" value="Set color">
</div>


<div style=""></div>

<!-- ###################################### HELP FLOATING BOX ################################### -->
<div class="floatingWindow"
	 id="floatingBoxHelp" 
	 style="display:none; 
	 position:absolute; 
     border-style: double;
     background-color: #DEA12F;
     opacity: 600;
     padding: 1px;">

        <legendstyle="top:143px"><h1>MetaboLight Spectrum viewer: <b>Help</b></h1></legend>
        <br>
-This is a tool allowing to <b>view</b> the result of your <b>chemistry experiments</b>.<br>
-It handles the following type of <b>experiment</b>:
<ul>
	<li>
		<b>N</b>uclear <b>M</b>agnetic <b>R</b>esonnance
		<ul>
			<li>
			H NMR
			</li>			
		</ul>
		<ul>
			<li>
			C NMR
			</li>
		</ul>
	</li>
	<li>
		<b>M</b>ass <b>S</b>pectrometry
		<ul>
			<li>
			One Dimension MS
			</li>			
		</ul>
		<ul>
			<li>
			Multi dimension MS (<b>CHALLENGE ACCEPTED</b>)
			</li>
		</ul>
	</li>
</ul>

-This viewer <b>allow you to</b>:<br>
<ul>
	<li>
		<b>	Cross talk : </b>
	</li>
	<li>
		<b>	Zoom on : </b>
		<ul>
			<li>
				The <i><b>spectrum</b></i>:  To zoom on the spectrum, drag a rectangle<br> over the area you wish to focus on
			</li>
			<li>
				The <i><b>molecule</b></i>:
			</li>
		</ul>
	</li>
	<li>
		<b> Localise :</b>  When you zoom on the spectrum, the<br> spectrum on the boottom right corner help you localise<br> where you are
	</li>
	<li>
		<b> Select :</b>
		<ul>
			<li>
				The <i><b>highlighting</b></i>:
			</li>
			<li>
				The <i><b>sensitivity</b></i>:
			</li>
		</ul>
		
	</li>
</ul>
<a 
 onmouseover="document.HideContent('floatingBoxHelp'); return true;"
 href="javascript:HideContent('floatingBoxColor')">
Hide the window
</a>
</div>


<!-- ####################################BOX THAT APPEARS WHEN WE SELECT MULTIPLE ATOMS OR BONDS TO IDENTIFY THE PEAKS -->
<div class="floatingBoxSelectMultiplePeaks"
	 id="floatingBoxSelectMultiplePeaks" 
	 style="display:none; 
	 position:absolute; 
     border-style: double;
     background-color: #DEA12F;
     opacity: 600;
     padding: 1px;">
     
     <li>
     <a href="javascript:specview.controller.plugins.Highlight.highlightSerieOfPeaks(document.editorObject)">Identify the peaks of the atoms you selected</a>
     </li><br>
     <li>
          <a href="javascript:specview.controller.plugins.Highlight.reDrawMolecule(document.editorObject)">Unselect everything</a>
	 </li><br>
	 <li>
	 <a 
 onmouseover="document.HideContent('floatingBoxSelectMultiplePeaks'); return true;"
 href="javascript:document.HideContent('floatingBoxColor')">
Hide the window
</a>
	 </li>
     <br>
     <br>
     <br>
     </div>
     <!-- 
     <APPLET name="javaApplet" 
					   code="CMLparser" 
					   archive="example.jar"
					   WIDTH="200" 
					   HEIGHT="70"
					   mayscript="mayscript">
This is where HelloWorld.class runs.</APPLET>

<param name="text" value="Bonjour les loulous">
</P>
      -->

<script type="text/javascript">

function dragger(){
	document.editorObject.specObject.isDraggingToolSelected = true;
	var $ = goog.dom.getElement;
	document.getElementById("draggingBarSpectrum").style.backgroundColor = "red"
	var limits = document.editorObject.specObject.draggingToolBoundaries;
	var sliderY=new goog.fx.Dragger($('draggingBarSpectrum'),null,limits) 
}
function setDraggingToolSelection(bool){
//	document.editorObject.specObject.isDraggingToolSelected = bool
//	alert(document.editorObject.specObject.isDraggingToolSelected)
}
function donnut(){
//	this.style.backgroundColor= '#E49319'
// alert(document.onmousedown)
}

</script>
  <div 
  	  id="win3" ,
	  style="
  	  display:none;
  	  position:absolute;
      left: 0px;
      top: 0px;
      width: 0px;
      height: 0px;
      background-color: transparent;
      border: 1px solid black;"
  >
  </div>
  
  
    <div 
  	  id="zoomRectangle" ,
	  style="
  	  display:none;
  	  position:absolute;
      left: 0px;
      top: 0px;
      width: 0px;
      height: 0px;
      border: 0px transparent #99F;
      font: bold 11px/18px arial;
      text-indent: 10px;
 	  opacity : 0.4;
 	  cursor:default;
      background-color: green";
  >
  </div>


<textarea id = "experimentInformation" rows="10" cols="20" wrap = "off"
		  style="
		    position : absolute;
		  	left : 620px;
		  	top : 370px;
	     		"
	     		


></textarea>

<textarea id = "peakInformation" rows="10" cols="20"
		  style="
		    position : absolute;
		  	left : 870px;
		  	top : 370px;
	     		"


></textarea>


</body>
</html>

